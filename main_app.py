import filesize
import vtmatch
import entropy_calculator
import imphash
import similar_hash
import yara_rules
import compilation_time
import shutil
import os
import report_generator

try:
    shutil.rmtree('report_gen/')
except:
    print

os.mkdir('report_gen')
print('++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')
print('Thank Your For Using This Tool To Analyse Malware Families')
print('++++++++++++++++++++++++++++++++++++++++++++++++++++++++++')

dir = input('Please Input The Malware Families Directory:')

if dir[-1] != '/':
    dir = dir + "/"
else:
    print

print('File Scanning Is Being Done On The Malwares.....')
filesize.filesize(dir)
print('Compilation Time Is Being Gathered From The Malware.....')
compilation_time.comp_time(dir)
print('Entropy Score Is Being Calculated For Multiple Malware.....')
entropy_calculator.multiple_sample(dir)

single_malware = input("Are You Also Interested In Scanning Entropy Of A Single Malware To Get More Detailed View of Its Frequency Bits\
\n1. Yes I'm Interested\n2. Nope I'm Not\nPick a Number >>")

if single_malware == '1':

    sing_dir = input('Please Input The Directory Of The Malware You Interested In And Hit "ENTER" Twice:\n>>')
    print('Entropy Score Is Being Calculated For A Single Malware.....')
    entropy_calculator.single_sample(sing_dir)

else:
    print('Ok')


print('Imphash Being Calculated For All The Malwares....')
imphash.imphash(dir)
print('SSDEEP Hash Being Calculated For All The Malwares....')
similar_hash.ssdeep(dir)
print('TLSH Hash Being Calculated For All The Malwares....')
similar_hash.tlsh_hash(dir)
print('Yara Rules is Being Matched For All The Malwares....')
yara_rules.yara_rules(dir)
print('Virus Total Scan Is Being Done...')
print()
vtmatch.vt_match(dir)
print('Full Report is Being Genrated')
report_generator.rep_gen()
