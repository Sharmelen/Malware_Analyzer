import os

def rep_gen():
    f = open('report_gen/full_report.html','w+')
    f = open('report_gen/full_report.html','r+')
    f.truncate(0)
    f = open('report_gen/full_report.html','a+')

    elements = os.listdir('report_gen')

    f.write('<html>')
    f.write('<h2>Complete Report on Malware Families That Has Been Analysed</h2><br>')


    if 'yara_rule.txt' in elements:
        f.write('==================================================================== <br>')
        f.write('<h3>This is Graph on Malware That Matches Same Yara Rule </h3> <br>')
        f.write('<img src="yararule.png" class = "center" height = "500" width = "500" ><br>')
        f.write('By using this graph we can actually tell how many malware that we have scanned <br>')
        f.write('matches the rules that we have predefined in our rules folder <br>')
        f.write('To see which group category each malware sample fell in please click this link \
        <a href="yara_rule.txt">Same Yara Rule Malware Group Category </a>')

    if 'imphash.txt' in elements:
        f.write('==================================================================== <br>')
        f.write('<h3>This is Graph on Malware That Has The Same Imphash </h3> <br>')
        f.write('<img src="imphash.png" class = "center" height = "500" width = "500" ><br>')
        f.write('By using this graph we can actually tell how many malware that we have scanned <br>')
        f.write('have the same imphash by<br>')
        f.write('To see which group category each malware sample fell in please click this link \
        <a href="imphash.txt">Same Imphash Malware Group Category </a>')

    if 'ent_mult.txt' in elements:
        f.write('==================================================================== <br>')
        f.write('<h3>This is Graph on Malware That Similar Entropy Score Range</h3> <br>')
        f.write('<img src="mult_ent.png" class = "center" height = "500" width = "500" ><br>')
        f.write('By using this graph we can actually tell how many malware that we have scanned <br>')
        f.write('have similar score range. From the graph we can deduce that the higher the score range<br>')
        f.write('the more non orderly the data is that could mean that the file is encrypted<br>')
        f.write('To see which group category each malware sample fell in please click this link \
        <a href="ent_mult.txt">Each Malwares Entropy Score</a><br>')

    if 'ent_sing.txt' in elements:
        f.write('==================================================================== <br>')
        f.write("<h3>This is Graph on a Single Malware's Entropy Score </h3> <br>")
        f.write('<img src="ent_sing.png" height = "500" width = "500" ><br>')
        v = open('report_gen/ent_sing.txt','r')
        f.write(str(v.read())+'<br>')
        f.write('By using this graph we can see in a more detailed view of the <br>')
        f.write('frequency of each byte value in the file <br>')

    if 'filesize.txt' in elements:
            f.write('==================================================================== <br>')
            f.write("<h3>This is Graph on a Malware File Size Score Range</h3> <br>")
            f.write('<img src="filesize.png" height = "500" width = "500" ><br>')
            f.write('By using this graph we can see what is the overall score range of malwares<br>')
            f.write('To see each malwares file sample you can click this link\
            <a href="filesize.txt">Each Malwares File Size</a><br>')

    if 'similar_hash_1.txt' in elements:
            f.write('==================================================================== <br>')
            f.write("<h3>This is a Graph on TLSH of Malware Samples</h3> <br>")
            f.write('<img src="tlsh.png" height = "500" width = "500" ><br>')
            f.write('This graph is resulted by comparing the TLSH hash of each malware pairs<br>')
            f.write('The higher the score range of each maleare pair the more unlikely the are the same malware<br>')
            f.write('To see each malwares pair score click this link\
            <a href="similar_hash_1.txt">Each Malwares Pair TLSH Score</a><br>')

    if 'ssdeep.png' in elements:
            f.write('==================================================================== <br>')
            f.write("<h3>This is a Graph on SSDEEP of Malware Samples</h3> <br>")
            f.write('<img src="ssdeep.png" height = "500" width = "500" ><br>')
            f.write('This graph is resulted by comparing the SSDEEP hash of each malware pairs<br>')
            f.write('The unlike TLSH for SSDEEP the higher the score range of each <br>')
            f.write('malware pair the more unlikely the are the same malware <br>')
            f.write('To see each malwares pair score click this link\
            <a href="result.txt">Each Malwares Pair SSDEEP Score</a><br>')

    if 'virustotal.txt' in elements:
        f.write('==================================================================== <br>')
        f.write("<h3>This is a Graph on Matches Found in Virus Total</h3> <br>")
        f.write('<img src="match_in_vt.png" height = "500" width = "500" >  \
           <img src="number_of_match.png" height = "500" width = "500" > <br>')
        f.write('The graph on the left shows the total match that is detected by virus total<br>\
        The graph on the right shows the a list of AV companies that detects the samples<br>')
        f.write('To see the group of the malware and the companies that detects the malware <br>\
        please click this link <a href="virustotal.txt">Malware Groups and Company That Detects The Malware</a><br>')

    print('Your Report Has Been Generated Check at "/report_gen/full_report.html"')



    f.write('<html>')
